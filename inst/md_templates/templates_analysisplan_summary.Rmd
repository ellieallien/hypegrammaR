---
title: "Analysisplan report"
author: "Eliora H"
date: "`r Sys.Date()`"
output: html_document
---


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(htmltools)
library(hypegrammaR)

```


```{r,include=T,warning=F,error=F,message=F,echo=FALSE,results='asis'}
resultlist <- x
analysisplan<-resultlist$analysisplan
knitr::kable(analysisplan,format = "html")
results<-resultlist$results
if(!is.null(questionnaire)){
  results<-lapply(results,map_to_labeled,questionnaire=questionnaire)
}
for(rq in unique(analysisplan$research.question)){
  htmltools::h1(rq) %>% as.character %>% cat
  in_rq<-(analysisplan$research.question==rq)
  for(srq in unique(analysisplan$sub.research.question)){
    in_srq<-(analysisplan$sub.research.question==srq)
    htmltools::h2(srq) %>% as.character %>% cat
    
    for(i in which(in_rq & in_srq)){
    if(!(is.null(results[[i]]$summary.statistic))){
      s <- results[[i]]$summary.statistic 
      lapply(s, function(x){ kable(x) %>% print})
    }
    if(!is.null(results[[i]]$hypothesis.test$result$p.value)){
    c(as.character(unique(results[[i]]$hypothesis.test$name)), "P Value:") %>% cat
    results[[i]]$hypothesis.test$result$p.value %>% print}
    kable(resultlist$results[[i]]$hypothesis.test %>% as.data.frame,format="html")    }
    
  }
  
}


```


